# ---------------------------------------------------------------------------
# æ ‡è®°æ¨¡æ¿ï¼ˆåœ¨ alignment è¾“å…¥/è¾“å‡ºä¸­åŒ…è£¹å„æ®µï¼Œä¾¿äºè§£æï¼‰
# ---------------------------------------------------------------------------
STEP_START = "<STEP_{i}>"
STEP_END   = "<END_STEP_{i}>"
FINAL_START = "<FINAL_STEP>"
FINAL_END   = "<END_FINAL_STEP>"

# ---------------------------------------------------------------------------
# Alignment ç³»ç»Ÿæç¤ºï¼ˆå‘ŠçŸ¥ LLM ä¿ç•™æ ‡è®°ã€ä»…åœ¨æ®µå†…æ’å…¥ observationï¼‰
# ---------------------------------------------------------------------------
ALIGN_SYS_PROMPT_LAST_STRONG = (
    "You are a helpful assistant. You need to decide what are the observations obtained by the visual manipulations (denoted by <abs_vis_token></abs_vis_token>). "
    "Put these observations in <observation>...</observation> and keep other texts unchanged. "
    "Segments are delimited by explicit markers like <STEP_0> ... <END_STEP_0> and <FINAL_STEP> ... <END_FINAL_STEP>.\n"
    "Rules:\n"
    "1. Do NOT remove, reorder, or rename any markers. Always output ALL markers exactly as given.\n"
    "2. Only observations after <abs_vis_token></abs_vis_token> should be wrapped in <observation>...</observation>.\nIf there's no <abs_vis_token></abs_vis_token> ahead, the description about the image doesn't count as an observation."
    "3. You should judge whether the content in \\boxed{} is obtained by observing the image or reasoning. If it is directly obtained by observing the image, put the observation in <observation>...</observation>; If it is obtained by repeating a previous observation, don't wrap it in <observation>...</observation>\n"
    "4. Do NOT add any new content in the reasoning chain.\n"
)

ALIGN_SYS_PROMPT_w_boxed = (
    "You are a helpful assistant. You need to decide what are the observations obtained by the visual manipulations (denoted by <abs_vis_token></abs_vis_token>). "
    "Put these observations in <observation>...</observation> and keep other texts unchanged. "
    "Segments are delimited by explicit markers like <STEP_0> ... <END_STEP_0> and <STEP_i> ... <END_STEP_i>.\n"
    "Rules:\n"
    "1. Do NOT remove, reorder, or rename any markers. Always output ALL markers exactly as given.\n"
    "2. Only observations after <abs_vis_token></abs_vis_token> should be wrapped in <observation>...</observation>.\nIf there's no <abs_vis_token></abs_vis_token> ahead, the description about the image doesn't count as an observation."
    "3. You should judge whether the content in \\boxed{} is obtained by observing the image or reasoning. If it is directly obtained by observing the image, put the observation in <observation>...</observation>; If it is obtained by repeating a previous observation, don't wrap it in <observation>...</observation>\n"
    "4. Do NOT add any new content in the reasoning chain.\n"
)

ALIGN_SYS_PROMPT_wo_boxed = (
    "You are a helpful assistant. You need to decide what are the observations obtained by the visual manipulations (denoted by <abs_vis_token></abs_vis_token>). "
    "Put these observations in <observation>...</observation> and keep other texts unchanged. "
    "Segments are delimited by explicit markers like <STEP_0> ... <END_STEP_0> and <STEP_i> ... <END_STEP_i>.\n"
    "Rules:\n"
    "1. Do NOT remove, reorder, or rename any markers. Always output ALL markers exactly as given.\n"
    "2. Only observations after <abs_vis_token></abs_vis_token> should be wrapped in <observation>...</observation>.\nIf there's no <abs_vis_token></abs_vis_token> ahead, the description about the image doesn't count as an observation."
    "3. Do NOT add any new content in the reasoning chain.\n"
)



examples_pool = {
    "CoF": {
        "sys_prompt": ALIGN_SYS_PROMPT_LAST_STRONG,
        "examples":(
        "Here are some examples:\n\n"
        "## Input: <STEP_0>To determine what the X-axis stands for, I need to analyze the X-axis in the image. However, the X-axis is not clearly visible in the initial view due to the image's resolution. To improve visibility, I need to explore step by step.<END_STEP_0>\n<STEP_1>\nI first locate the X-axis within the bounding box [1118, 1092, 1208, 1131]. I zoom in on this area to obtain a refined visual embedding. \n<abs_vis_token></abs_vis_token>\n<END_STEP_1>\n<FINAL_STEP>\\boxed{Visit}<END_FINAL_STEP>\n\n"
        "## Your output: <STEP_0>To determine what the X-axis stands for, I need to analyze the X-axis in the image. However, the X-axis is not clearly visible in the initial view due to the image's resolution. To improve visibility, I need to explore step by step.<END_STEP_0>\n<STEP_1>\nI first locate the X-axis within the bounding box [1118, 1092, 1208, 1131]. I zoom in on this area to obtain a refined visual embedding. \n<abs_vis_token></abs_vis_token>\n<END_STEP_1>\n<FINAL_STEP><observation>\\boxed{Visit}</observation><END_FINAL_STEP>\n\n\n"
        "## Input: <STEP_0>Now let me take a closer look at the image. <abs_vis_token></abs_vis_token>\n<END_STEP_0>\n<STEP_1>The cropped section explains that the process involves several stages, with the first stage being autonomous state estimation from the onboard sensors.\n\n<END_STEP_1>\n<FINAL_STEP>\\boxed{Autonomous state estimation from the onboard sensors}\n\n"
        "## Your output: <STEP_0>Now let me take a closer look at the image. <abs_vis_token></abs_vis_token>\n<END_STEP_0>\n<STEP_1><observation>The cropped section explains that the process involves several stages, with the first stage being autonomous state estimation from the onboard sensors.</observation>\n\n<END_STEP_1>\n<FINAL_STEP>\\boxed{Autonomous state estimation from the onboard sensors}\n\n\n"
        "## Input: <STEP_0>The image shows an emblem carved into a wall. The emblem features a crowned eagle with outstretched wings, holding a sphere in one claw. Below the eagle, there is a decorative object at the bottom of the emblem, which appears to have a distinct shape.\n\nNow I will zoom in to look clearer at the object at the bottom of the emblem.<abs_vis_token></abs_vis_token>\n<END_STEP_0>\n<STEP_1>The cropped part doesn't contain the target object, I will zoom in again.<END_STEP_1>\n<FINAL_STEP><abs_vis_token></abs_vis_token>\n\nThe object at the bottom of the emblem has a leaf-like shape. It appears to be a stylized or ornate leaf design, possibly resembling an oak leaf or another type of foliage.\n\n\\boxed{\\text{leaf}}<FINAL_STEP>\n\n"
        "## Your output: <STEP_0>The image shows an emblem carved into a wall. The emblem features a crowned eagle with outstretched wings, holding a sphere in one claw. Below the eagle, there is a decorative object at the bottom of the emblem, which appears to have a distinct shape.\n\nNow I will zoom in to look clearer at the object at the bottom of the emblem.<abs_vis_token></abs_vis_token>\n<END_STEP_0>\n<STEP_1><observation>The cropped part doesn't contain the target object,</observation> I will zoom in again.<END_STEP_1>\n<FINAL_STEP><abs_vis_token></abs_vis_token>\n\n<observation>The object at the bottom of the emblem has a leaf-like shape. It appears to be a stylized or ornate leaf design, possibly resembling an oak leaf or another type of foliage.</observation>\n\n\\boxed{\\text{leaf}}<END_FINAL_STEP>\n\n\n"
    )},
    "CoM_w_MathVista": {
        "sys_prompt": ALIGN_SYS_PROMPT_wo_boxed,
        "examples":
        ("Here are some examples:\n\n"
        "## Input: <STEP_0>Draw a straight line and obtain the new image after drawing the line. <abs_vis_token></abs_vis_token><END_STEP_0>\n<STEP_1>In the new image, find the year with PDI=1.5 for the North Atlantic cyclone.<END_STEP_1>\n<STEP_2>The value of PDI=1.5 corresponds to the index point two positions after 1975, so the year for PDI=1.5 is 1977, hence the answer is 1977.<END_STEP_2>\n\n"
        "## Your output: <STEP_0>Draw a straight line and obtain the new image after drawing the line. <abs_vis_token></abs_vis_token><END_STEP_0>\n<STEP_1>In the new image, find the year with PDI=1.5 for the North Atlantic cyclone.<END_STEP_1>\n<STEP_2><observation>The value of PDI=1.5 corresponds to the index point two positions after 1975, so the year for PDI=1.5 is 1977, hence the answer is 1977.</observation><END_STEP_2>\n\n\n"
        "## Input: <STEP_0>Draw a straight line and obtain the new image after the line is drawn. <abs_vis_token></abs_vis_token><END_STEP_0>\n<STEP_1>Because the blue bar exceeded 400 starting from the year 2055, the answer is \"2055\".<END_STEP_2>\n\n"
        "## Your output: <STEP_0>Draw a straight line and obtain the new image after the line is drawn. <abs_vis_token></abs_vis_token><END_STEP_0>\n<STEP_1><observation>Because the blue bar exceeded 400 starting from the year 2055</observation>, the answer is \"2055\".<END_STEP_2>\n\n\n"
        "## Input: <STEP_0>Draw a line to obtain the new image after the line is drawn. <abs_vis_token></abs_vis_token><END_STEP_0>\n<STEP_1>Outline each bar column, which are located at Netflix, VoD.pI, Wirtualna Polska VOD services, Player.pl, VoD.tvp.pI, CDA.pI, HBOGo.pI, lpla TV, Chili.com, NCplusgo.pl. <abs_vis_token></abs_vis_token><END_STEP_1>\n<STEP_2>Analyze the value of each bar in relation to x=1. The values obtained from HBOGo.pI, lpla TV, Chili.com, and NCplusgo.pl are all less than one million, with respective values of 0.63, 0.59, 0.25, and 0.21.<END_STEP_2>\n<STEP_3>Calculate their total sum as 0.63 + 0.59 + 0.25 + 0.21 = 1.68, so the answer is 1.68.<END_STEP_3>\n\n"
        "## Your output: <STEP_0>Draw a line to obtain the new image after the line is drawn. <abs_vis_token></abs_vis_token><END_STEP_0>\n<STEP_1>Outline each bar column, which are located at Netflix, VoD.pI, Wirtualna Polska VOD services, Player.pl, VoD.tvp.pI, CDA.pI, HBOGo.pI, lpla TV, Chili.com, NCplusgo.pl. <abs_vis_token></abs_vis_token><END_STEP_1>\n<STEP_2>Analyze the value of each bar in relation to x=1. <observation>The values obtained from HBOGo.pI, lpla TV, Chili.com, and NCplusgo.pl are all less than one million, with respective values of 0.63, 0.59, 0.25, and 0.21.</observation><END_STEP_2>\n<STEP_3>Calculate their total sum as 0.63 + 0.59 + 0.25 + 0.21 = 1.68, so the answer is 1.68.<END_STEP_3>\n\n\n"
        )},
    "ReFocus": (
        "Here are some examples:\n\n"
        "## Input: <STEP_0>This is a horizontal bar chart image. I need to find the number of aircraft due to enter the 'lease end' phase in 2018. The relevant y value is 'AerCap', as it has the highest number of lease returns and extensions.<abs_vis_token></abs_vis_token><END_STEP_0>\n<FINAL_STEP>To determine the number of aircraft due to enter the 'lease end' phase in 2018 for AerCap, we need to analyze the horizontal bar chart provided:\n\n1. The chart shows the number of lease returns and extensions for various leasing companies.\n2. The y-axis lists the leasing companies, with \"AerCap\" being the first entry.\n3. The x-axis represents the number of lease returns and extensions.\n4. The bar for AerCap extends to the far right, indicating the highest number of lease returns and extensions among the listed companies.\n5. The length of the AerCap bar corresponds to a value of approximately 190 on the x-axis.\n\nGiven this information, the number of aircraft due to enter the 'lease end' phase in 2018 for AerCap is approximately 190.\n\n\\boxed{190}<END_FINAL_STEP>\n\n"
        "## Your output: <STEP_0>This is a horizontal bar chart image. I need to find the number of aircraft due to enter the 'lease end' phase in 2018. The relevant y value is 'AerCap', as it has the highest number of lease returns and extensions.<abs_vis_token></abs_vis_token><END_STEP_0>\n<FINAL_STEP>To determine the number of aircraft due to enter the 'lease end' phase in 2018 for AerCap, we need to analyze the horizontal bar chart provided:\n\n<observation>1. The chart shows the number of lease returns and extensions for various leasing companies.</observation>\n<observation>2. The y-axis lists the leasing companies, with \"AerCap\" being the first entry.</observation>\n<observation>3. The x-axis represents the number of lease returns and extensions.</observation>\n<observation>4. The bar for AerCap extends to the far right, indicating the highest number of lease returns and extensions among the listed companies.</observation>\n5. <observation>The length of the AerCap bar corresponds to a value of approximately 190 on the x-axis.</observation>\n\nGiven this information, the number of aircraft due to enter the 'lease end' phase in 2018 for AerCap is approximately 190.\n\n\\boxed{190}<END_FINAL_STEP>\n\n\n"
        "## Input: <STEP_0>This is a horizontal bar chart image. I need to focus on the part when the y-axis value equals 'Consumer Electronics' to find out the number of retail chains in Austria in 2020.<abs_vis_token></abs_vis_token><END_STEP_0>\n<FINAL_STEP>To determine the number of retail chains in Austria in the year 2020 for the category \"Consumer Electronics,\" let's follow these steps:\n\n1. **Identify the relevant category**: The question asks specifically about \"Consumer Electronics.\"\n\n2. **Locate the category in the chart**: In the chart, \"Consumer Electronics\" is listed as one of the categories on the y-axis.\n\n3. **Read the value for \"Consumer Electronics\"**: The bar corresponding to \"Consumer Electronics\" shows a value of 21.\n\n4. **Verify the year**: The chart does not explicitly state the year, but the question specifies the year 2020. Since the chart is from Statista 2021 and is likely reporting data for the previous year, it is reasonable to assume the data is for 2020.\n\n5. **Final Answer**: The number of retail chains in Austria for \"Consumer Electronics\" in 2020 is 21.\n\n\\boxed{21}<END_FINAL_STEP>\n\n"
        "## Your output: <STEP_0>This is a horizontal bar chart image. I need to focus on the part when the y-axis value equals 'Consumer Electronics' to find out the number of retail chains in Austria in 2020.<abs_vis_token></abs_vis_token><END_STEP_0>\n<FINAL_STEP>To determine the number of retail chains in Austria in the year 2020 for the category \"Consumer Electronics,\" let's follow these steps:\n\n1. **Identify the relevant category**: The question asks specifically about \"Consumer Electronics.\"\n\n2. **Locate the category in the chart**: In the chart, \"Consumer Electronics\" is listed as one of the categories on the y-axis.\n\n3. **Read the value for \"Consumer Electronics\"**: The bar corresponding to \"Consumer Electronics\" shows a value of 21.\n\n4. **Verify the year**: The chart does not explicitly state the year, but the question specifies the year 2020. Since the chart is from Statista 2021 and is likely reporting data for the previous year, it is reasonable to assume the data is for 2020.\n\n<observation>5. **Final Answer**: The number of retail chains in Austria for \"Consumer Electronics\" in 2020 is 21.</observation>\n\n\\boxed{21}<END_FINAL_STEP>\n\n\n"
        "## Input: <STEP_0>This is a vertical bar chart image, and I need to focus on the part where the x-axis value is '35 to 54' to find out how many veterans were employed.<abs_vis_token></abs_vis_token><END_STEP_0>\n<FINAL_STEP>To determine the number of veterans employed in the United States in 2019 for the age group \"35 to 54,\" we need to focus on the blue section of the bar corresponding to this age group.\n\nFrom the chart:\n- The blue section (representing \"Employed\") for the age group \"35 to 54\" is labeled as **3,290,974**.\n\nThus, the number of veterans employed in the United States in 2019 for the age group \"35 to 54\" is:\n\n\\boxed{3290974}<END_FINAL_STEP>\m\n\n"
        "## Your output: <STEP_0>This is a vertical bar chart image, and I need to focus on the part where the x-axis value is '35 to 54' to find out how many veterans were employed.<abs_vis_token></abs_vis_token><END_STEP_0>\n<FINAL_STEP>To determine the number of veterans employed in the United States in 2019 for the age group \"35 to 54,\" we need to focus on the blue section of the bar corresponding to this age group.\n\n<observation>From the chart:\n- The blue section (representing \"Employed\") for the age group \"35 to 54\" is labeled as **3,290,974**.</observation>\n\nThus, the number of veterans employed in the United States in 2019 for the age group \"35 to 54\" is:\n\n\\boxed{3290974}<END_FINAL_STEP>\m\n\n"
        ),
    "Visual_CoT_v7w": (
        "## Input: <STEP_0><abs_vis_token></abs_vis_token><END_STEP_0><FINAL_STEP>To determine where the racquet is, let's analyze the image:\n\n1. The image shows a person holding a tennis racquet.\n2. The racquet is clearly visible in the person's right hand.\n\nGiven this information, the correct answer is:\n\n\\boxed{C}<FINAL_STEP>\n\n"
        "## Your output: <STEP_0><abs_vis_token></abs_vis_token><END_STEP_0><FINAL_STEP>To determine where the racquet is, let's analyze the image:\n\n<observation>1. The image shows a person holding a tennis racquet.</observation>\n<observation>2. The racquet is clearly visible in the person's right hand.</observation>\n\nGiven this information, the correct answer is:\n\n\\boxed{C}<FINAL_STEP>\n\n\n"
        "## Input: <STEP_0><abs_vis_token></abs_vis_token><END_STEP_0><FINAL_STEP>The image shows a close-up of a wrist with a watch band. The watch band is clearly visible on the wrist, which is likely the left wrist based on the angle and positioning.\n\nGiven the options:\n\n- **A: Left wrist.**\n- **B: Right wrist.**\n- **C: Dresser.**\n- **D: On the person's left arm.**\n\nThe most accurate choice is **D: On the person's left arm**, as it directly describes the location of the watch band on the person's arm.\n\nThus, the answer is: \\boxed{D}<FINAL_STEP>\n\n"
        "## Your output: <STEP_0><abs_vis_token></abs_vis_token><END_STEP_0><FINAL_STEP><observation>The image shows a close-up of a wrist with a watch band</observation>. <observation>The watch band is clearly visible on the wrist,</observation> which is likely the left wrist based on the angle and positioning.\n\nGiven the options:\n\n- **A: Left wrist.**\n- **B: Right wrist.**\n- **C: Dresser.**\n- **D: On the person's left arm.**\n\nThe most accurate choice is **D: On the person's left arm**, as it directly describes the location of the watch band on the person's arm.\n\nThus, the answer is: \\boxed{D}<FINAL_STEP>\n\n\n"
    ),
    "Zebra_CoT_visual_search": {
        "sys_prompt": ALIGN_SYS_PROMPT_wo_boxed,
        "examples": (
        "Here are some examples:\n\n"
        "## Input: <STEP_0>I need to examine the image to identify the object situated below the sandwich.<END_STEP_0>\n<STEP_1>To determine what is below the sandwich, I will focus on the area directly underneath it. I will use a visual aid to highlight this region.\n<abs_vis_token></abs_vis_token><END_STEP_1>\n<STEP_2>The red line indicates the approximate bottom edge of the sandwich. The object visible below this line is a white plate.<END_STEP_2>\n<STEP_3>Based on the image, the sandwich is resting on a plate, which is below it.<END_STEP_3>\n\n"
        "## Your output: <STEP_0>I need to examine the image to identify the object situated below the sandwich.<END_STEP_0>\n<STEP_1>To determine what is below the sandwich, I will focus on the area directly underneath it. I will use a visual aid to highlight this region.\n<abs_vis_token></abs_vis_token><END_STEP_1>\n<STEP_2><observation>The red line indicates the approximate bottom edge of the sandwich. The object visible below this line is a white plate.</observation><END_STEP_2>\n<STEP_3>Based on the image, <observation>the sandwich is resting on a plate, which is below it.</observation><END_STEP_3>\n\n\n"
        "## Input: <STEP_0>The question asks to identify the person holding the textile handbag in the image.<END_STEP_0>\n<STEP_1>To clearly identify the person and the handbag, I will focus on the central figure in the image.\n<abs_vis_token></abs_vis_token><END_STEP_1>\n<STEP_2>The zoomed-in view shows a person wearing a skirt suit and holding a handbag, along with other items. The person has characteristics typically associated with a woman.<END_STEP_2>\n<STEP_3>Based on the visual evidence in the detailed view, the person holding the textile handbag is a woman.<END_STEP_3>\n\n"
        "## Your output: <STEP_0>The question asks to identify the person holding the textile handbag in the image.<END_STEP_0>\n<STEP_1>To clearly identify the person and the handbag, I will focus on the central figure in the image.\n<abs_vis_token></abs_vis_token><END_STEP_1>\n<STEP_2><observation>The zoomed-in view shows a person wearing a skirt suit and holding a handbag, along with other items. The person has characteristics typically associated with a woman.</observation><END_STEP_2>\n<STEP_3>Based on the visual evidence in the detailed view, <observation>the person holding the textile handbag is a woman.</observation><END_STEP_3>\n\n"
        )
    },
    "Zebra_CoT_geometry": {
        "sys_prompt": ALIGN_SYS_PROMPT_wo_boxed,
        "examples": (
        "Here are some examples:\n\n"
        "## Input: <STEP_0>Since the placement of pegs of each color is forced at every step by the constraints, there is only one possible arrangement of pegs on the board. This unique arrangement is as follows:\nRow 1: Y\nRow 2: R, Y\nRow 3: G, R, Y\nRow 4: B, G, R, Y\nRow 5: O, B, G, R, Y\nThe following image illustrates this unique configuration.\n<abs_vis_token></abs_vis_token>\n\n<END_STEP_0>\n<STEP_1>The image visually confirms the step-by-step deduction. Each row and column adheres to the constraint of not having duplicate colors. For example, column 1 (leftmost) contains O, B, G, R, Y from bottom to top. Row 5 (bottommost) contains O, B, G, R, Y from left to right. All constraints are met, and since each decision was forced, this is the only possible arrangement.<END_STEP_1>\n\n"
        "## Your output: <STEP_0>Since the placement of pegs of each color is forced at every step by the constraints, there is only one possible arrangement of pegs on the board. This unique arrangement is as follows:\nRow 1: Y\nRow 2: R, Y\nRow 3: G, R, Y\nRow 4: B, G, R, Y\nRow 5: O, B, G, R, Y\nThe following image illustrates this unique configuration.\n<abs_vis_token></abs_vis_token>\n\n<END_STEP_0>\n<STEP_1>The image visually confirms the step-by-step deduction. Each row and column adheres to the constraint of not having duplicate colors. <observation>For example, column 1 (leftmost) contains O, B, G, R, Y from bottom to top. Row 5 (bottommost) contains O, B, G, R, Y from left to right.</observation> All constraints are met, and since each decision was forced, this is the only possible arrangement.<END_STEP_1>\n\n\n"
        "## Input: <STEP_0>Next, we need to count the number of paths that pass through the missing segments. The problem image shows two missing horizontal segments. To analyze these, let's label the points at the beginning of these missing segments. The following diagram shows these points labeled as C and D.\n<abs_vis_token></abs_vis_token><END_STEP_0>\n<STEP_1>In the diagram, point A is at coordinates (0,0). Point C is reached by moving 4 units East and 1 unit South from A, so its coordinates are C=(4,1). Point D is reached by moving 4 units East and 2 units South from A, so its coordinates are D=(4,2). Point B is at coordinates (9,3).\nThe first missing segment, $S_1$, connects point C=(4,1) to point $C'=(5,1)$ (i.e., one unit East of C).\nThe second missing segment, $S_2$, connects point D=(4,2) to point $D'=(5,2)$ (i.e., one unit East of D).\nAny path that uses $S_1$ must travel $A \\to C \\to C' \\to B$. Any path that uses $S_2$ must travel $A \\to D \\to D' \\to B$.<END_STEP_1><STEP_2>Let's calculate the number of paths that use the first missing segment $S_1$ (from $C=(4,1)$ to $C'=(5,1)$).\n1.  Number of paths from $A=(0,0)$ to $C=(4,1)$: This requires 4 East moves and 1 South move. The number of such paths is $\\binom{4+1}{1} = \\binom{5}{1} = 5$.\n2.  Number of paths from $C$ to $C'$: This is 1 (along the segment $S_1$).\n3.  Number of paths from $C'=(5,1)$ to $B=(9,3)$: This requires $(9-5)=4$ East moves and $(3-1)=2$ South moves. The number of such paths is $\\binom{4+2}{2} = \\binom{6}{2} = \\frac{6 \\times 5}{2 \\times 1} = 15$.\nSo, the total number of paths from A to B passing through segment $S_1$ is $5 \\times 1 \\times 15 = 75$.\n\n<END_STEP_2>\n\n"
        "## Your output: <STEP_0>Next, we need to count the number of paths that pass through the missing segments. The problem image shows two missing horizontal segments. To analyze these, let's label the points at the beginning of these missing segments. The following diagram shows these points labeled as C and D.\n<abs_vis_token></abs_vis_token><END_STEP_0>\n<STEP_1><observation>In the diagram, point A is at coordinates (0,0). Point C is reached by moving 4 units East and 1 unit South from A, so its coordinates are C=(4,1). Point D is reached by moving 4 units East and 2 units South from A, so its coordinates are D=(4,2). Point B is at coordinates (9,3).\nThe first missing segment, $S_1$, connects point C=(4,1) to point $C'=(5,1)$ (i.e., one unit East of C).\nThe second missing segment, $S_2$, connects point D=(4,2) to point $D'=(5,2)$ (i.e., one unit East of D).</observation>\nAny path that uses $S_1$ must travel $A \\to C \\to C' \\to B$. Any path that uses $S_2$ must travel $A \\to D \\to D' \\to B$.<END_STEP_1><STEP_2>Let's calculate the number of paths that use the first missing segment $S_1$ (from $C=(4,1)$ to $C'=(5,1)$).\n1.  Number of paths from $A=(0,0)$ to $C=(4,1)$: This requires 4 East moves and 1 South move. The number of such paths is $\\binom{4+1}{1} = \\binom{5}{1} = 5$.\n2.  Number of paths from $C$ to $C'$: This is 1 (along the segment $S_1$).\n3.  Number of paths from $C'=(5,1)$ to $B=(9,3)$: This requires $(9-5)=4$ East moves and $(3-1)=2$ South moves. The number of such paths is $\\binom{4+2}{2} = \\binom{6}{2} = \\frac{6 \\times 5}{2 \\times 1} = 15$.\nSo, the total number of paths from A to B passing through segment $S_1$ is $5 \\times 1 \\times 15 = 75$.\n\n<END_STEP_2>\n\n"
        )
    },
    "Zebra_CoT_maze": {
        "sys_prompt": ALIGN_SYS_PROMPT_wo_boxed,
        "examples": (
        "Here is an example:\n\n"
        "## Input: <STEP_0>The problem requires us to find the correct sequence of movements that allows the character to navigate from the starting position (top-left, where the character is) to the goal (bottom-right, where the gift box is) without encountering any of the ice holes. The grid and the ice holes are shown in the initial problem image.\n<END_STEP_0>\n<STEP_1>To determine the safe path, I will systematically trace each given navigation option on the grid, observing whether it successfully reaches the gift box or falls into an ice hole. Each arrow represents a step in the corresponding direction.\n<END_STEP_1>\n<STEP_2>Let's begin by evaluating Option (A): ğŸ‘‰ ğŸ‘‰ ğŸ‘‰ ğŸ‘‰ ğŸ‘‰ ğŸ‘‰ ğŸ‘‡ ğŸ‘‰ ğŸ‘‰ ğŸ‘‡. To visualize this path and check its validity, I will generate an image showing the character's movement.\n<abs_vis_token></abs_vis_token>\nUpon tracing the path for Option A, as depicted in the visual thought, it becomes clear that the character moves right into an ice hole in the second step. Therefore, Option A is not a safe navigation methodology.\n<END_STEP_2>\n<STEP_3>Next, I will examine Option (B): ğŸ‘‡ ğŸ‘‰ ğŸ‘‰ ğŸ‘‡ ğŸ‘‡ ğŸ‘‡ ğŸ‘‰ ğŸ‘‰ ğŸ‘‡ ğŸ‘‰. A visual representation of this path will help confirm if it successfully avoids all hazards and reaches the destination.\n<abs_vis_token></abs_vis_token>\nThe visual trace for Option B demonstrates that the character successfully navigates through the grid, avoiding all the ice holes, and safely reaches the gift box at the end. This appears to be a viable solution.\n<END_STEP_3>\n<STEP_4>: Now, let's check Option (C): ğŸ‘‰ ğŸ‘‡ ğŸ‘‰ ğŸ‘‡ ğŸ‘‰ ğŸ‘‰ ğŸ‘‡ ğŸ‘‡ ğŸ‘‰ ğŸ‘‡. I will generate an image to plot this path and observe its outcome.\n<abs_vis_token></abs_vis_token>\nThe generated image for Option C reveals that the character falls into an ice hole after several steps, specifically at the sixth step where it moves right. Thus, Option C is not a safe path.\n<END_STEP_4>\n<STEP_5>: Moving on to Option (D): ğŸ‘‡ ğŸ‘‡ ğŸ‘‡ ğŸ‘‰ ğŸ‘‰ ğŸ‘‡ ğŸ‘‰ ğŸ‘‡ ğŸ‘‰ ğŸ‘‰. Let's create a visual trace for this sequence of movements to see if it leads to a safe arrival.\n<abs_vis_token></abs_vis_token>\nAs shown in the visual trace for Option D, the character falls into an ice hole very early in the path, specifically on the third step when moving down. Therefore, Option D is also an unsafe navigation method.\n<END_STEP_5>\n<STEP_6>: Finally, I will evaluate Option (E): ğŸ‘‰ ğŸ‘‡ ğŸ‘‡ ğŸ‘‰ ğŸ‘‰ ğŸ‘‰ ğŸ‘‡ ğŸ‘‡ ğŸ‘‰ ğŸ‘‡. A visual representation will confirm if this path is safe.\n<abs_vis_token></abs_vis_token>\nThe visual tracing of Option E indicates that the character falls into an ice hole on the second step when moving down. This path, too, fails to provide a safe route to the conclusion.\n<END_STEP_6>\n<STEP_7>: After meticulously checking all the provided options by visually tracing their paths on the grid, only Option B successfully leads the character to the goal without encountering any hazards. All other options resulted in the character falling into an ice hole.<END_STEP_7>\n\n"
        "## Your outpur: <STEP_0>The problem requires us to find the correct sequence of movements that allows the character to navigate from the starting position (top-left, where the character is) to the goal (bottom-right, where the gift box is) without encountering any of the ice holes. The grid and the ice holes are shown in the initial problem image.\n<END_STEP_0>\n<STEP_1>To determine the safe path, I will systematically trace each given navigation option on the grid, observing whether it successfully reaches the gift box or falls into an ice hole. Each arrow represents a step in the corresponding direction.\n<END_STEP_1>\n<STEP_2>Let's begin by evaluating Option (A): ğŸ‘‰ ğŸ‘‰ ğŸ‘‰ ğŸ‘‰ ğŸ‘‰ ğŸ‘‰ ğŸ‘‡ ğŸ‘‰ ğŸ‘‰ ğŸ‘‡. To visualize this path and check its validity, I will generate an image showing the character's movement.\n<abs_vis_token></abs_vis_token>\nUpon tracing the path for Option A, as depicted in the visual thought, <observation>it becomes clear that the character moves right into an ice hole in the second step.</observation> Therefore, Option A is not a safe navigation methodology.\n<END_STEP_2>\n<STEP_3>Next, I will examine Option (B): ğŸ‘‡ ğŸ‘‰ ğŸ‘‰ ğŸ‘‡ ğŸ‘‡ ğŸ‘‡ ğŸ‘‰ ğŸ‘‰ ğŸ‘‡ ğŸ‘‰. A visual representation of this path will help confirm if it successfully avoids all hazards and reaches the destination.\n<abs_vis_token></abs_vis_token>\n<observation>The visual trace for Option B demonstrates that the character successfully navigates through the grid, avoiding all the ice holes, and safely reaches the gift box at the end.</observation> This appears to be a viable solution.\n<END_STEP_3>\n<STEP_4>: Now, let's check Option (C): ğŸ‘‰ ğŸ‘‡ ğŸ‘‰ ğŸ‘‡ ğŸ‘‰ ğŸ‘‰ ğŸ‘‡ ğŸ‘‡ ğŸ‘‰ ğŸ‘‡. I will generate an image to plot this path and observe its outcome.\n<abs_vis_token></abs_vis_token>\n<observation>The generated image for Option C reveals that the character falls into an ice hole after several steps, specifically at the sixth step where it moves right.</observation> Thus, Option C is not a safe path.\n<END_STEP_4>\n<STEP_5>: Moving on to Option (D): ğŸ‘‡ ğŸ‘‡ ğŸ‘‡ ğŸ‘‰ ğŸ‘‰ ğŸ‘‡ ğŸ‘‰ ğŸ‘‡ ğŸ‘‰ ğŸ‘‰. Let's create a visual trace for this sequence of movements to see if it leads to a safe arrival.\n<abs_vis_token></abs_vis_token>\nAs shown in the visual trace for Option D, <observation>the character falls into an ice hole very early in the path, specifically on the third step when moving down.</observation> Therefore, Option D is also an unsafe navigation method.\n<END_STEP_5>\n<STEP_6>: Finally, I will evaluate Option (E): ğŸ‘‰ ğŸ‘‡ ğŸ‘‡ ğŸ‘‰ ğŸ‘‰ ğŸ‘‰ ğŸ‘‡ ğŸ‘‡ ğŸ‘‰ ğŸ‘‡. A visual representation will confirm if this path is safe.\n<abs_vis_token></abs_vis_token>\n<observation>The visual tracing of Option E indicates that the character falls into an ice hole on the second step when moving down.</observation> This path, too, fails to provide a safe route to the conclusion.\n<END_STEP_6>\n<STEP_7>: After meticulously checking all the provided options by visually tracing their paths on the grid, only Option B successfully leads the character to the goal without encountering any hazards. All other options resulted in the character falling into an ice hole.<END_STEP_7>\n\n\n"
        )
    },
    "Zebra_CoT_physics": {
        "sys_prompt": ALIGN_SYS_PROMPT_wo_boxed,
        "examples": (
        "Here is an example:\n\n"
        "## Input: <STEP_0>\nThe central part of this problem is to determine whether the block remains stationary or begins to slide. This involves a comparison between the component of gravity pulling the block down the incline and the maximum possible static friction force that can oppose this motion.\n\n<END_STEP_0>\n<STEP_1>\nTo begin the analysis, I will construct a free-body diagram. This visual representation will help me identify and organize all the forces acting on the block: its weight ($F_g$), the normal force ($N$) exerted by the plane, and the friction force ($F_f$).\n<abs_vis_token></abs_vis_token>\n\n<END_STEP_1>\n<STEP_2>\nThe initial free-body diagram shows the gravitational force acting vertically downwards. To effectively apply Newton's laws in a coordinate system aligned with the inclined plane, it is advantageous to resolve the gravitational force into two components: one perpendicular to the plane ($F_{g\\perp}$) and one parallel to it ($F_{g\\parallel}$). The following sketch illustrates this decomposition.<abs_vis_token></abs_vis_token>\n<END_STEP_2>\n<STEP_3>:\nWith the forces properly resolved in the second diagram, I can now perform the calculations. The total weight of the block is $F_g = mg = (6.1 \\text{ kg})(9.8 \\text{ m/s}^2) = 59.78 \\text{ N}$. Using trigonometry, the components are:\nComponent perpendicular to the incline: $F_{g\\perp} = mg \\cos(45^\\circ) = 59.78 \\text{ N} \\times \\cos(45^\\circ) \\approx 42.27 \\text{ N}$.\nComponent parallel to the incline: $F_{g\\parallel} = mg \\sin(45^\\circ) = 59.78 \\text{ N} \\times \\sin(45^\\circ) \\approx 42.27 \\text{ N}$.\n<END_STEP_3>\n<STEP_4>:\nThe block does not accelerate in the direction perpendicular to the plane. Therefore, the forces in this direction must be balanced. The normal force ($N$) is equal in magnitude to the perpendicular component of gravity: $N = F_{g\\perp} = 42.27 \\text{ N}$.\n\<END_STEP_4>\n<STEP_5>:\nNow that I have the normal force, I can calculate the maximum static friction force ($F_{s,max}$), which is the threshold that must be overcome for motion to begin.\n$F_{s,max} = \\mu_s N = (1.0) \\times (42.27 \\text{ N}) = 42.27 \\text{ N}$.\n\n<END_STEP_5>\n<STEP_6>\nThe critical step is to compare the force pulling the block down the incline ($F_{g\\parallel}$) with the maximum available static friction ($F_{s,max}$).\nDriving force: $F_{g\\parallel} = 42.27 \\text{ N}$.\nMaximum resisting force: $F_{s,max} = 42.27 \\text{ N}$.\nSince the driving force, $F_{g\\parallel}$, is equal to the maximum static friction force, $F_{s,max}$, the block is on the verge of sliding but does not move.\n\n<END_STEP_6>\n<STEP_7>\nBecause the block remains stationary, the static friction force adjusts its magnitude to be exactly equal and opposite to the parallel component of gravity. Thus, the actual friction force is $F_s = F_{g\\parallel} = 42.27 \\text{ N}$. As the net force on the block is zero, its acceleration must also be zero.<END_STEP_7>\n\n"
        "## Your output:<STEP_0>\nThe central part of this problem is to determine whether the block remains stationary or begins to slide. This involves a comparison between the component of gravity pulling the block down the incline and the maximum possible static friction force that can oppose this motion.\n\n<END_STEP_0>\n<STEP_1>\nTo begin the analysis, I will construct a free-body diagram. This visual representation will help me identify and organize all the forces acting on the block: its weight ($F_g$), the normal force ($N$) exerted by the plane, and the friction force ($F_f$).\n<abs_vis_token></abs_vis_token>\n\n<END_STEP_1>\n<STEP_2>\n<observation>The initial free-body diagram shows the gravitational force acting vertically downwards.</observation> To effectively apply Newton's laws in a coordinate system aligned with the inclined plane, it is advantageous to resolve the gravitational force into two components: one perpendicular to the plane ($F_{g\\perp}$) and one parallel to it ($F_{g\\parallel}$). The following sketch illustrates this decomposition.<abs_vis_token></abs_vis_token>\n<END_STEP_2>\n<STEP_3>:\nWith the forces properly resolved in the second diagram, I can now perform the calculations. The total weight of the block is $F_g = mg = (6.1 \\text{ kg})(9.8 \\text{ m/s}^2) = 59.78 \\text{ N}$. Using trigonometry, the components are:\nComponent perpendicular to the incline: $F_{g\\perp} = mg \\cos(45^\\circ) = 59.78 \\text{ N} \\times \\cos(45^\\circ) \\approx 42.27 \\text{ N}$.\nComponent parallel to the incline: $F_{g\\parallel} = mg \\sin(45^\\circ) = 59.78 \\text{ N} \\times \\sin(45^\\circ) \\approx 42.27 \\text{ N}$.\n<END_STEP_3>\n<STEP_4>:\nThe block does not accelerate in the direction perpendicular to the plane. Therefore, the forces in this direction must be balanced. The normal force ($N$) is equal in magnitude to the perpendicular component of gravity: $N = F_{g\\perp} = 42.27 \\text{ N}$.\n\<END_STEP_4>\n<STEP_5>:\nNow that I have the normal force, I can calculate the maximum static friction force ($F_{s,max}$), which is the threshold that must be overcome for motion to begin.\n$F_{s,max} = \\mu_s N = (1.0) \\times (42.27 \\text{ N}) = 42.27 \\text{ N}$.\n\n<END_STEP_5>\n<STEP_6>\nThe critical step is to compare the force pulling the block down the incline ($F_{g\\parallel}$) with the maximum available static friction ($F_{s,max}$).\nDriving force: $F_{g\\parallel} = 42.27 \\text{ N}$.\nMaximum resisting force: $F_{s,max} = 42.27 \\text{ N}$.\nSince the driving force, $F_{g\\parallel}$, is equal to the maximum static friction force, $F_{s,max}$, the block is on the verge of sliding but does not move.\n\n<END_STEP_6>\n<STEP_7>\nBecause the block remains stationary, the static friction force adjusts its magnitude to be exactly equal and opposite to the parallel component of gravity. Thus, the actual friction force is $F_s = F_{g\\parallel} = 42.27 \\text{ N}$. As the net force on the block is zero, its acceleration must also be zero.<END_STEP_7>\n\n\n"
        )
    },
    
}